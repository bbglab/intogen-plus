Bootstrap: docker
From: rocker/r-ver:4.1

%environment
    export LC_ALL=C.UTF-8
    
%runscript
    exec "Rscript" "/seismic/SEISMIC.R" "$@"

%setup
    mkdir ${SINGULARITY_ROOTFS}/seismic/
    cp install_R_dependencies.R ${SINGULARITY_ROOTFS}/seismic/
    cp SEISMIC.R ${SINGULARITY_ROOTFS}/seismic/
    cp -r data/ ${SINGULARITY_ROOTFS}/seismic/data/
    cp -r config/ ${SINGULARITY_ROOTFS}/seismic/config/
    chmod -R a+rx ${SINGULARITY_ROOTFS}/seismic/

%post
   
    # <--- Install R --->
    apt-get update
    apt-get install -y --no-install-recommends \
    apt-utils \
    r-base-html \
    r-doc-html \
    r-cran-devtools \
    r-bioc-biostrings \
    r-bioc-genomicranges \
    r-bioc-rsamtools \
    r-cran-ade4 \
    r-cran-seqinr \
    procps apt-utils \
    locales-all \
    libcurl4-openssl-dev \
    libssl-dev \
    libxml2-dev \
    libfontconfig1-dev \
    libharfbuzz-dev  \
    libfribidi-dev  \
    libfreetype6-dev \
    libpng-dev \
    libtiff5-dev \
    libjpeg-dev \
    libcairo2-dev \
    libxt-dev \
    libmagick++-dev

    echo "Installing dependancies"
    Rscript /seismic/install_R_dependencies.R 

    
